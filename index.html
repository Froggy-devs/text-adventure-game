<script>
  const storyElement = document.getElementById('story');
  const choicesElement = document.querySelector('.choices');
  const chestVideo = document.getElementById('chestVideo');

  // Game state and story progression
  const gameData = {
    start: {
      text: "You are standing at a crossroads. Do you go left or right?",
      choices: [
        { text: "Go left", next: "leftPath" },
        { text: "Go right", next: "rightPath" }
      ]
    },
    leftPath: {
      text: "You walk down a forest path and find a treasure chest. Do you open it?",
      choices: [
        { text: "Open the chest", next: "openChest" },
        { text: "Walk away", next: "walkAway" }
      ]
    },
    rightPath: {
      text: "You encounter a mysterious wizard who offers you a potion. Do you drink it?",
      choices: [
        { text: "Drink the potion", next: "drinkPotion" },
        { text: "Refuse the potion", next: "refusePotion" }
      ]
    },
    openChest: {
      text: "You open the chest...",
      choices: [] // No further choices as video will play
    },
    walkAway: {
      text: "You walk away and leave the treasure behind. The game is over.",
      choices: [
        { text: "Restart", next: "start" }
      ]
    },
    drinkPotion: {
      text: "The potion makes you stronger! You feel invincible. The game is over.",
      choices: [
        { text: "Restart", next: "start" }
      ]
    },
    refusePotion: {
      text: "The wizard vanishes in a puff of smoke. You walk away. The game is over.",
      choices: [
        { text: "Restart", next: "start" }
      ]
    }
  };

  // Function to display the story text and choices
  function displayStory(storyKey) {
    const story = gameData[storyKey];
    storyElement.textContent = story.text;
    choicesElement.innerHTML = ''; // Clear previous choices

    // Hide video initially
    chestVideo.style.display = 'none';
    chestVideo.pause();
    chestVideo.currentTime = 0;

    if (storyKey === 'openChest') {
      // Display the video when the chest is opened
      chestVideo.style.display = 'block';
      chestVideo.play();

      // After the video ends, display game-over text and restart button
      chestVideo.onended = () => {
        storyElement.textContent = "The chest contains gold! You're rich! The game is over.";
        const restartButton = document.createElement('button');
        restartButton.textContent = "Restart";
        restartButton.onclick = () => displayStory('start');
        choicesElement.appendChild(restartButton);
      };
    } else {
      // Add choice buttons if they exist
      story.choices.forEach(choice => {
        const button = document.createElement('button');
        button.textContent = choice.text;
        button.onclick = () => displayStory(choice.next);
        choicesElement.appendChild(button);
      });
    }
  }

  // Start the game
  displayStory('start');
</script>

